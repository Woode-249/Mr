<!DOCTYPE html>  
<html lang="ar" dir="rtl">  
<head>  
  <meta charset="utf-8" />  
  <meta name="viewport" content="width=device-width,initial-scale=1" />  
  <title>Profile</title>  
  
  <!-- Lucide Icons -->  
  <script src="https://unpkg.com/lucide@latest"></script>  
  <!-- Chart.js -->  
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>  
  
  <style>  
    :root{  
      --bg-left:#0a1931;    /* أزرق غامق */  
      --bg-mid:#061121;  
      --bg-right:#000000;  
      --sky:#87ceeb;  
      --muted:#d0d8e0;  
      --glass-border: rgba(255,255,255,0.10);  
    }  
  
    /* --- Global --- */  
    html,body{height:100%;}  
    body{  
      margin:0;  
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;  
      color: #e9f0f6;  
      background: linear-gradient(to left, var(--bg-left) 0%, var(--bg-mid) 50%, var(--bg-right) 100%);  
      background-attachment: fixed; /* ثابت أثناء التمرير */  
      -webkit-font-smoothing:antialiased;  
      -moz-osx-font-smoothing:grayscale;  
    }  
    a{ color:inherit; text-decoration:none; }  
  
    /* Navbar */  
    .navbar{  
      display:flex;  
      align-items:center;  
      justify-content:space-between;  
      padding: 12px 18px;  
      background: rgba(255,255,255,0.03);  
      backdrop-filter: blur(14px) saturate(160%);  
      border-bottom:1px solid rgba(255,255,255,0.04);  
      position: sticky;  
      top:0;  
      z-index: 50;  
    }  
    .nav-left { display:flex; align-items:center; gap:14px; }  
    .site-title{  
      color:var(--sky);  
      font-weight:700;  
      font-size:1.15rem;  
    }  
    .nav-actions{ display:flex; gap:8px; align-items:center; }  
  
    .icon-btn{  
      background: rgba(255,255,255,0.06);  
      border:none;  
      padding:8px;  
      border-radius:10px;  
      cursor:pointer;  
      display:inline-flex;  
      align-items:center;  
      justify-content:center;  
      transition: transform .12s ease, background .18s ease, box-shadow .18s ease;  
      box-shadow: 0 3px 10px rgba(0,0,0,0.35);  
    }  
    .icon-btn:hover{  
      transform: translateY(-3px);  
      background: rgba(135,206,235,0.14);  
    }  
    .icon-btn svg{ width:20px;height:20px;color:var(--sky); }  
  
    /* Layout */  
    .main {  
      max-width:1150px;  
      margin: 22px auto;  
      padding: 18px;  
      display: grid;  
      gap: 18px;  
      grid-template-columns: 1fr 420px;  
    }  
  
    /* RESPONSIVE */  
    @media (max-width: 980px){  
      .main{ grid-template-columns: 1fr; padding: 14px; }  
      .right-col { order: 2; }  
    }  
  
    /* Glass card base */  
    .card{  
      background: linear-gradient(180deg, rgba(255,255,255,0.045), rgba(255,255,255,0.03));  
      border: 1px solid var(--glass-border);  
      border-radius: 14px;  
      padding: 16px;  
      box-shadow: 0 10px 30px rgba(0,0,0,0.45);  
      backdrop-filter: blur(28px) saturate(180%);  
      position: relative;  
      overflow: hidden;  
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;  
    }  
    /* stronger blue glow on hover */  
    .card:hover{  
      transform: translateY(-6px);  
      box-shadow: 0 18px 50px rgba(0,0,0,0.55), 0 0 30px rgba(135,206,235,0.06);  
      border-color: rgba(135,206,235,0.14);  
    }  
    /* hover glow */  
    .card::after{  
      content:"";  
      position:absolute; inset: -40% -40% -40% -40%;  
      background: radial-gradient(circle at 10% 10%, rgba(135,206,235,0.06), transparent 20%),  
                  radial-gradient(circle at 90% 90%, rgba(135,206,235,0.02), transparent 10%);  
      pointer-events:none;  
      transition: opacity .18s ease;  
      opacity: .5;  
      mix-blend-mode: screen;  
    }  
    .card:hover::after{ opacity: 0.95; }  
  
    /* Profile header */  
    .profile-header{  
      display:flex;  
      gap:16px;  
      align-items:center;  
      flex-wrap:wrap;  
    }  
    .avatar{  
      width:84px;height:84px;border-radius:999px;  
      background: linear-gradient(135deg, rgba(255,255,255,0.06), rgba(255,255,255,0.02));  
      border: 2px solid rgba(255,255,255,0.08);  
      display:flex;align-items:center;justify-content:center;  
      font-size:28px;color:var(--sky);  
      box-shadow: inset 0 -6px 18px rgba(0,0,0,0.25);  
      position:relative;  
      cursor:pointer;  
      transition: box-shadow .18s ease, transform .12s ease;  
      flex-shrink:0;  
    }  
    .avatar:focus{ outline:none; transform: translateY(-3px); box-shadow: 0 6px 20px rgba(135,206,235,0.12); }  
    .avatar svg{ width:38px; height:38px; color:var(--sky); }  
    .avatar img{ width:100%;height:100%;border-radius:999px;object-fit:cover;display:block; transition:opacity .2s ease; }  
  
    .profile-meta{ flex:1; min-width:220px; }  
    .name{ font-size:1.25rem;color:var(--sky); font-weight:700; margin-bottom:4px; }  
    .meta-sub{ color:var(--muted); font-size:0.92rem; margin-bottom:8px; display:flex; gap:10px; align-items:center; flex-wrap:wrap; }  
    .small-btn{  
      background: rgba(135,206,235,0.12);  
      color: #00101a;  
      padding:8px 12px;  
      border-radius:10px;  
      border:none;  
      cursor:pointer;  
      font-weight:600;  
    }  

    /* Referral UI */  
    .referral { margin-top:8px; display:flex; gap:8px; align-items:center; flex-wrap:wrap; }  
    .ref-link { display:inline-block; max-width:380px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; background: rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.04); padding:8px 10px; border-radius:8px; color:var(--sky); font-weight:600; }  
    .ref-copy { background:transparent; border:1px solid rgba(255,255,255,0.06); color:var(--sky); padding:8px 10px; border-radius:8px; cursor:pointer; }  

    /* Summary cards */  
    .summary-grid{  
      display:grid;  
      grid-template-columns: repeat(auto-fit,minmax(180px,1fr));  
      gap:12px;  
      margin-top:14px;  
    }  
    .summary-item{ padding:12px;border-radius:12px; }  
    .summary-value{ font-size:1.15rem; font-weight:700; color:var(--sky); }  
    .summary-label{ color:var(--muted); font-size:0.92rem; margin-bottom:8px; }  
  
    /* Progress */  
    .progress-wrap{ margin-top:10px; }  
    .progress-bar{  
      height:12px;border-radius:999px;background: rgba(255,255,255,0.06); overflow:hidden;border:1px solid rgba(255,255,255,0.04);  
    }  
    .progress-fill{  
      height:100%; width:0%;  
      background: linear-gradient(90deg, rgba(135,206,235,0.95), rgba(135,206,235,0.6));  
      border-radius:999px; transition: width .8s cubic-bezier(.2,.9,.2,1);  
    }  
  
    /* Chart card */  
    .chart-container{ padding:8px; }  
    canvas{ max-width:100%; height:220px !important; }  
  
    /* Transactions */  
    .tx-table{ width:100%; border-collapse:collapse; font-size:0.95rem; }  
    .tx-table thead th{ text-align:right; color:var(--muted); font-weight:600; padding:10px 8px; font-size:0.86rem; border-bottom:1px solid rgba(255,255,255,0.04); }  
    .tx-table tbody td{ padding:10px 8px; border-bottom:1px solid rgba(255,255,255,0.03); color:#e9f0f6; text-align:right; }  
    .badge{ display:inline-block;padding:6px 8px;border-radius:8px;font-weight:700;font-size:0.82rem; }  
    .badge.success{ background: rgba(50,205,140,0.12); color:#9ef3b4; }  
    .badge.pending{ background: rgba(255,206,86,0.08); color:#ffe59a; }  
    .tx-scroll{ max-height:250px; overflow:auto; padding-right:6px; }  
  
    /* Right column small cards */  
    .right-col { display:flex; flex-direction:column; gap:12px; }  
    .plan-row{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:10px;border-radius:10px; border:1px solid rgba(255,255,255,0.03); background:rgba(255,255,255,0.018); }  
    .plan-name{ color:var(--sky); font-weight:700; }  
  
    /* Settings list */  
    .settings-list{ display:flex; flex-direction:column; gap:8px; margin-top:8px; }  
    .setting-item{ display:flex; align-items:center; justify-content:space-between; gap:12px; background: rgba(255,255,255,0.02); padding:10px;border-radius:10px; border:1px solid rgba(255,255,255,0.03); }  
    .toggle{ width:44px; height:24px; background: rgba(255,255,255,0.06); border-radius:999px; position:relative; cursor:pointer; border:1px solid rgba(255,255,255,0.03); }  
    .toggle .dot{ position:absolute; left:4px; top:3px; width:18px;height:18px;border-radius:999px;background:#fff; transition:left .18s ease, background .18s ease; box-shadow:0 3px 6px rgba(0,0,0,0.35); }  
    .toggle.on{ background: linear-gradient(90deg, rgba(135,206,235,0.95), rgba(135,206,235,0.6)); }  
    .toggle.on .dot{ left:22px; background:#00202a; }  
  
    /* Modals */  
    .modal-wrap{ display:none; position:fixed; inset:0; background:rgba(0,0,0,0.55); backdrop-filter:blur(6px); z-index:200; align-items:center; justify-content:center; padding:20px; }  
    .modal-card{ width:100%; max-width:520px; background: rgba(255,255,255,0.04); border-radius:12px; padding:18px; border:1px solid rgba(135,206,235,0.12); box-shadow:0 14px 40px rgba(0,0,0,0.6); position:relative; }  
    .modal-close{ position:absolute; top:10px; left:12px; background:transparent;border:none;color:var(--sky); font-size:20px; cursor:pointer; }  
  
    /* small helpers */  
    .muted{ color:var(--muted); }  
    .row{ display:flex; gap:12px; align-items:center; }  
    .stack{ display:flex; flex-direction:column; gap:6px; }  
    .cta{ background:var(--sky); color:#00121a; padding:10px 12px; border-radius:10px; border:none; font-weight:700; cursor:pointer; }  

    /* subtle page-level blue highlight when mouse moves over content area */
    .main:hover .card { filter: drop-shadow(0 0 8px rgba(135,206,235,0.02)); }  
  </style>  
</head>  
<body>  
  
  <!-- NAV -->  
  <div class="navbar card" role="navigation" aria-label="Top bar">  
    <div class="nav-left">  
      <div class="site-title" data-i18n="profileTitle">Profile</div>  
      <!-- site brand removed as requested -->  
    </div>  
  
    <div class="nav-actions">  
      <button class="icon-btn" id="langToggle" aria-label="toggle language" title="Toggle language">  
        <i data-lucide="globe"></i>  
      </button>  
  
      <button class="icon-btn" id="backBtn" aria-label="back" title="العودة">  
        <i data-lucide="arrow-right"></i>  
      </button>  
    </div>  
  </div>  
  
  <!-- MAIN -->  
  <main class="main" role="main">  
    <!-- LEFT COL -->  
    <section class="left-col">  
      <!-- Profile header -->  
      <section class="card profile-header" aria-label="profile header">  
        <div class="avatar" id="avatar" tabindex="0" role="button" aria-label="تغيير الصورة">  
          <!-- default icon from Lucide (will be rendered to SVG) -->  
          <i data-lucide="user" id="avatarIcon"></i>  
        </div>  

        <!-- hidden file input for selecting avatar -->
        <input type="file" id="avatarInput" accept="image/*" style="display:none" />

        <div class="profile-meta">  
          <div class="name" id="userName">عمار أحمد</div>  
          <div class="meta-sub">  
            <div data-i18n="accountId">Account ID: <strong id="accountId">MRC-00927</strong></div>  
            <div class="muted">•</div>  
            <div data-i18n="memberSince">عضو منذ: <strong id="memberSince">2024-06-15</strong></div>  
          </div>  

          <!-- Referral link (new) -->
          <div class="referral" aria-label="Referral link">
            <a id="refLink" class="ref-link" href="#" target="_blank" rel="noopener noreferrer"></a>
            <button id="copyRefBtn" class="ref-copy" aria-label="نسخ رابط الإحالة">نسخ رابط الإحالة</button>
          </div>

          <div class="row" style="margin-top:10px;">  
            <button class="small-btn" id="editProfileBtn" data-i18n="editProfile">تعديل الحساب</button>  
          </div>  
        </div>  
      </section>  
  
      <!-- Summary -->  
      <section class="card" aria-label="investment summary">  
        <div class="stack">  
          <div style="display:flex;justify-content:space-between;align-items:center;">  
            <div class="muted" data-i18n="investmentSummary">ملخص المحفظة</div>  
            <div class="muted" style="font-size:0.9rem;" data-i18n="lastUpdate">آخر تحديث: <span id="lastUpdate">اليوم</span></div>  
          </div>  
  
          <div class="summary-grid" style="margin-top:12px;">  
            <div class="summary-item">  
              <div class="summary-label" data-i18n="totalBalance">إجمالي الرصيد</div>  
              <div class="summary-value" id="totalBalance">3.42 BTC</div>  
              <div class="muted">≈ 51,230 USD</div>  
            </div>  
  
            <div class="summary-item">  
              <div class="summary-label" data-i18n="totalProfits">إجمالي الأرباح</div>  
              <div class="summary-value" id="totalProfits">+2.75 BTC</div>  
              <div class="muted">≈ 42,300 USD</div>  
            </div>  
  
            <div class="summary-item">  
              <div class="summary-label" data-i18n="monthlyROI">نسبة العائد الشهري</div>  
              <div class="summary-value" id="monthlyROI">+12.8%</div>  
              <div class="muted">متوسط آخر 3 أشهر</div>  
            </div>  
  
            <div class="summary-item">  
              <div class="summary-label" data-i18n="currentPlan">الخطة الحالية</div>  
              <div class="summary-value" id="currentPlan">VIP-8</div>  
              <div class="muted">ربح يومي: 35$</div>  
            </div>  
          </div>  
  
          <div class="progress-wrap" style="margin-top:14px;">  
            <div class="muted" data-i18n="progressToGoal">التقدم نحو الهدف (10 BTC)</div>  
            <div class="progress-bar" style="margin-top:8px;">  
              <div class="progress-fill" id="progressFill" style="width:68%"></div>  
            </div>  
            <div class="muted" style="font-size:0.9rem;margin-top:8px;">68% • <span id="toGoal">6.8 BTC</span></div>  
          </div>  
        </div>  
      </section>  
  
      <!-- Transactions -->  
      <section class="card" aria-label="recent transactions">  
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">  
          <div class="muted" data-i18n="recentTransactions">أحدث العمليات</div>  
          <button class="small-btn" id="viewAllTx" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--sky);" data-i18n="viewAll">عرض الكل</button>  
        </div>  
  
        <div class="tx-scroll" role="table">  
          <table class="tx-table" aria-label="transactions table">  
            <thead>  
              <tr>  
                <th data-i18n="date">التاريخ</th>  
                <th data-i18n="type">النوع</th>  
                <th data-i18n="amount">المبلغ</th>  
                <th data-i18n="status">الحالة</th>  
              </tr>  
            </thead>  
            <tbody id="txBody">  
              <!-- sample rows -->  
              <tr>  
                <td>2025-08-06</td>  
                <td>أرباح يومية</td>  
                <td>0.15 BTC</td>  
                <td><span class="badge success">تم</span></td>  
              </tr>  
              <tr>  
                <td>2025-07-28</td>  
                <td>سحب</td>  
                <td>0.30 BTC</td>  
                <td><span class="badge pending">قيد المراجعة</span></td>  
              </tr>  
              <tr>  
                <td>2025-07-20</td>  
                <td>إيداع</td>  
                <td>0.50 BTC</td>  
                <td><span class="badge success">تم</span></td>  
              </tr>  
            </tbody>  
          </table>  
        </div>  
      </section>  
    </section>  
  
    <!-- RIGHT COL -->  
    <aside class="right-col">  
      <!-- Chart -->  
      <section class="card chart-container" aria-label="growth chart">  
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">  
          <div class="muted" data-i18n="profitGrowth">نمو الأرباح (آخر 12 شهر)</div>  
          <div class="muted" style="font-size:0.9rem;">USD</div>  
        </div>  
        <canvas id="profitChart" aria-label="Profit growth chart"></canvas>  
      </section>  
  
      <!-- Active plans -->  
      <section class="card" aria-label="active plans">  
        <div style="display:flex;justify-content:space-between;align-items:center;">  
          <div class="muted" data-i18n="activePlans">الخطط النشطة</div>  
          <div class="muted" style="font-size:0.9rem" data-i18n="managePlans">إدارة</div>  
        </div>  
  
        <div style="margin-top:10px; display:flex;flex-direction:column;gap:8px;">  
          <div class="plan-row">  
            <div>  
              <div class="plan-name">VIP-8</div>  
              <div class="muted" style="font-size:0.86rem;">إيداع: $150 • ربح يومي: 35$</div>  
            </div>  
            <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end;">  
              <button class="cta small" data-i18n="upgradePlan" onclick="openPlanDetails('VIP-8')">ترقية</button>  
              <button class="small-btn" onclick="openPlanDetails('VIP-8')" data-i18n="details">تفاصيل</button>  
            </div>  
          </div>  
  
          <div class="plan-row">  
            <div>  
              <div class="plan-name">VIP-3</div>  
              <div class="muted" style="font-size:0.86rem;">إيداع: $25 • ربح يومي: 4$</div>  
            </div>  
            <div>  
              <button class="small-btn" onclick="openPlanDetails('VIP-3')" data-i18n="details">تفاصيل</button>  
            </div>  
          </div>  
        </div>  
      </section>  
  
      <!-- Settings -->  
      <section class="card" aria-label="account settings">  
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">  
          <div class="muted" data-i18n="settings">الإعدادات</div>  
          <button class="small-btn" id="changePassBtn" data-i18n="changePassword">تغيير كلمة المرور</button>  
        </div>  
  
        <div class="settings-list">  
          <div class="setting-item">  
            <div>2FA</div>  
            <div class="toggle" id="twoFAToggle" role="switch" aria-checked="false"><div class="dot"></div></div>  
          </div>  
  
          <div class="setting-item">  
            <div data-i18n="notifications">الإشعارات</div>  
            <div class="toggle on" id="notifToggle" role="switch" aria-checked="true"><div class="dot"></div></div>  
          </div>  
  
          <div class="setting-item">  
            <div data-i18n="paymentMethods">طرق الدفع</div>  
            <div>  
              <button class="small-btn" id="managePayments" data-i18n="manage">إدارة</button>  
            </div>  
          </div>  
        </div>  
      </section>  
    </aside>  
  </main>  
  
  <!-- EDIT PROFILE MODAL -->  
  <div class="modal-wrap" id="editModal" role="dialog" aria-hidden="true" aria-labelledby="editTitle">  
    <div class="modal-card card">  
      <button class="modal-close" id="closeEdit">&times;</button>  
      <h3 id="editTitle" data-i18n="editProfile">تعديل الحساب</h3>  
  
      <form id="editForm" style="margin-top:12px;">  
        <div style="display:flex;flex-direction:column;gap:10px;">  
          <input type="text" id="inpName" placeholder="الاسم الكامل" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#e9f0f6" />  
          <input type="email" id="inpEmail" placeholder="البريد الإلكتروني" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#e9f0f6" />  
          <input type="tel" id="inpPhone" placeholder="رقم الهاتف" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#e9f0f6" />  
          <div style="display:flex;gap:8px;justify-content:flex-end;">  
            <button type="button" class="small-btn" id="saveProfile" data-i18n="save">حفظ</button>  
            <button type="button" class="small-btn" id="cancelEdit" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--sky);" data-i18n="cancel">إلغاء</button>  
          </div>  
        </div>  
      </form>  
    </div>  
  </div>  
  
  <!-- CHANGE PASS MODAL -->  
  <div class="modal-wrap" id="passModal" role="dialog" aria-hidden="true" aria-labelledby="passTitle">  
    <div class="modal-card card">  
      <button class="modal-close" id="closePass">&times;</button>  
      <h3 id="passTitle" data-i18n="changePassword">تغيير كلمة المرور</h3>  
  
      <form id="passForm" style="margin-top:12px;">  
        <div style="display:flex;flex-direction:column;gap:10px;">  
          <input type="password" id="oldPass" placeholder="كلمة المرور الحالية" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#e9f0f6" />  
          <input type="password" id="newPass" placeholder="كلمة المرور الجديدة" style="padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.06);background:transparent;color:#e9f0f6" />  
          <div style="display:flex;gap:8px;justify-content:flex-end;">  
            <button type="button" class="small-btn" id="savePass" data-i18n="save">حفظ</button>  
            <button type="button" class="small-btn" id="cancelPass" style="background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--sky);" data-i18n="cancel">إلغاء</button>  
          </div>  
        </div>  
      </form>  
    </div>  
  </div>  
  
<script>  
  // ---------------------------  
  // Initialization & utilities  
  // ---------------------------  
  // ensure icons will render after DOM loaded  
  document.addEventListener('DOMContentLoaded', ()=> lucide.createIcons());  

  // Simple i18n dictionary (siteBrand removed per request)  
  const i18n = {  
    ar: {  
      profileTitle: "Profile",  
      editProfile: "تعديل الحساب",  
      deposit: "إيداع",  
      withdraw: "سحب",  
      investmentSummary: "ملخص المحفظة",  
      lastUpdate: "آخر تحديث",  
      totalBalance: "إجمالي الرصيد",  
      totalProfits: "إجمالي الأرباح",  
      monthlyROI: "نسبة العائد الشهري",  
      currentPlan: "الخطة الحالية",  
      progressToGoal: "التقدم نحو الهدف (10 BTC)",  
      recentTransactions: "أحدث العمليات",  
      viewAll: "عرض الكل",  
      date: "التاريخ",  
      type: "النوع",  
      amount: "المبلغ",  
      status: "الحالة",  
      profitGrowth: "نمو الأرباح (آخر 12 شهر)",  
      activePlans: "الخطط النشطة",  
      managePlans: "إدارة",  
      upgradePlan: "ترقية",  
      details: "تفاصيل",  
      settings: "الإعدادات",  
      changePassword: "تغيير كلمة المرور",  
      notifications: "الإشعارات",  
      paymentMethods: "طرق الدفع",  
      manage: "إدارة",  
      save: "حفظ",  
      cancel: "إلغاء",  
      progressLabel: "التقدم"  
    },  
    en: {  
      profileTitle: "Profile",  
      editProfile: "Edit profile",  
      deposit: "Deposit",  
      withdraw: "Withdraw",  
      investmentSummary: "Investment summary",  
      lastUpdate: "Last update",  
      totalBalance: "Total balance",  
      totalProfits: "Total profits",  
      monthlyROI: "Monthly ROI",  
      currentPlan: "Current plan",  
      progressToGoal: "Progress to goal (10 BTC)",  
      recentTransactions: "Recent transactions",  
      viewAll: "View all",  
      date: "Date",  
      type: "Type",  
      amount: "Amount",  
      status: "Status",  
      profitGrowth: "Profit growth (12 months)",  
      activePlans: "Active plans",  
      managePlans: "Manage",  
      upgradePlan: "Upgrade",  
      details: "Details",  
      settings: "Settings",  
      changePassword: "Change password",  
      notifications: "Notifications",  
      paymentMethods: "Payment methods",  
      manage: "Manage",  
      save: "Save",  
      cancel: "Cancel",  
      progressLabel: "Progress"  
    }  
  };  
  
  // translate all elements that have data-i18n attribute  
  function translateTo(lang){  
    document.documentElement.lang = (lang === 'ar' ? 'ar' : 'en');  
    document.documentElement.dir = (lang === 'ar' ? 'rtl' : 'ltr');  
  
    document.querySelectorAll('[data-i18n]').forEach(el=>{  
      const key = el.getAttribute('data-i18n');  
      if(i18n[lang] && i18n[lang][key]) el.textContent = i18n[lang][key];  
    });  
  }  
  
  // default language Arabic  
  let currentLang = 'ar';  
  translateTo(currentLang);  
  
  // Toggle language button  
  const langToggle = document.getElementById('langToggle');  
  if(langToggle) langToggle.addEventListener('click', ()=>{  
    currentLang = (currentLang === 'ar' ? 'en' : 'ar');  
    translateTo(currentLang);  
  });  
  
  // ---------------------------  
  // Mock / dynamic data for chart  
  // ---------------------------  
  const mockMonthlyUSD = [4200,4500,4600,4800,5000,5200,5400,5600,6000,6400,7000,7600]; // sample  
  const monthsLabel = ['Sep','Oct','Nov','Dec','Jan','Feb','Mar','Apr','May','Jun','Jul','Aug'];  
  
  // ---------------------------  
  // Chart.js setup  
  // ---------------------------  
  const ctx = document.getElementById('profitChart')?.getContext('2d');  
  if(ctx){  
    new Chart(ctx, {  
      type: 'line',  
      data: {  
        labels: monthsLabel,  
        datasets: [{  
          label: 'USD',  
          data: mockMonthlyUSD,  
          fill: true,  
          tension: 0.28,  
          pointRadius: 4,  
          borderWidth: 2,  
          borderColor: 'rgba(135,206,235,0.95)',  
          backgroundColor: (ctx)=> {  
            const g = ctx.createLinearGradient(0, 0, 0, 220);  
            g.addColorStop(0, 'rgba(135,206,235,0.18)');  
            g.addColorStop(1, 'rgba(135,206,235,0.02)');  
            return g;  
          }  
        }]  
      },  
      options: {  
        maintainAspectRatio:false,  
        plugins: {  
          legend: { display: false },  
          tooltip: {   
            usePointStyle: true,  
            backgroundColor: '#02101a',  
            titleColor:'#87ceeb',  
            bodyColor:'#e9f0f6',  
            borderColor:'rgba(135,206,235,0.1)',  
            borderWidth:1  
          }  
        },  
        scales: {  
          x: { grid:{ display:false }, ticks:{ color:'#cfe8f3' } },  
          y: {  
            grid:{ color:'rgba(255,255,255,0.03)' },  
            ticks:{ color:'#cfe8f3' }  
          }  
        }  
      }  
    });  
  }  
  
  // ---------------------------  
  // Progress animation  
  // ---------------------------  
  window.addEventListener('load', ()=>{  
    requestAnimationFrame(()=> {  
      const pf = document.getElementById('progressFill');  
      if(pf) pf.style.width = '68%';  
    });  
  });  
  
  // ---------------------------  
  // Avatar upload handling  
  // ---------------------------  
  const avatar = document.getElementById('avatar');  
  const avatarInput = document.getElementById('avatarInput');  

  if(avatar && avatarInput){  
    // clicking avatar opens file picker
    avatar.addEventListener('click', ()=> avatarInput.click());  
    // keyboard accessibility (Enter or Space)
    avatar.addEventListener('keydown', (e)=> { if(e.key === 'Enter' || e.key === ' ') { e.preventDefault(); avatarInput.click(); } });

    avatarInput.addEventListener('change', (ev)=>{  
      const file = ev.target.files && ev.target.files[0];  
      if(!file) return;  
      if(!file.type.startsWith('image/')) return alert('Please select an image file.');  

      const reader = new FileReader();  
      reader.onload = function(e){  
        // replace icon with chosen image
        avatar.innerHTML = '';  
        const img = document.createElement('img');  
        img.src = e.target.result;  
        img.alt = 'avatar';  
        img.onload = ()=> { img.style.opacity = '1'; };  
        avatar.appendChild(img);  
      };  
      reader.readAsDataURL(file);  
    });  
  }  

  // ---------------------------  
  // Referral link generation & copy  
  // ---------------------------  
  (function setupReferral(){  
    const accountEl = document.getElementById('accountId');  
    const refLinkEl = document.getElementById('refLink');  
    const copyBtn = document.getElementById('copyRefBtn');  
    let accountIdVal = 'guest';  
    if(accountEl) accountIdVal = accountEl.textContent.trim().replace(/^#?/,'');  

    // prefer real origin, fallback
    let origin = 'https://example.com';  
    try{ if(location && location.origin && !location.origin.includes('file://')) origin = location.origin; }catch(e){ origin = 'https://example.com'; }

    const referral = `${origin}/signup?ref=${encodeURIComponent(accountIdVal)}`;  
    if(refLinkEl){ refLinkEl.href = referral; refLinkEl.textContent = referral; }  

    if(copyBtn){  
      copyBtn.addEventListener('click', async ()=>{  
        try{  
          await navigator.clipboard.writeText(referral);  
          const old = copyBtn.textContent;  
          copyBtn.textContent = 'تم النسخ!';  
          copyBtn.disabled = true;  
          setTimeout(()=>{ copyBtn.textContent = old; copyBtn.disabled = false; }, 1400);  
        }catch(err){  
          // fallback
          const ta = document.createElement('textarea'); ta.value = referral; document.body.appendChild(ta); ta.select();  
          try{ document.execCommand('copy'); alert('تم النسخ'); }catch(e){ prompt('انسخ رابط الإحالة يدوياً:', referral); }  
          ta.remove();  
        }  
      });  
    }  
  })();  

  // ---------------------------  
  // Modal controls & other UI hooks  
  // ---------------------------  
  function openModal(id){   
    const modal = document.getElementById(id);  
    if(!modal) return;  
    modal.style.display = 'flex';  
    modal.setAttribute('aria-hidden','false');  
  }  
  function closeModal(id){  
    const modal = document.getElementById(id);  
    if(!modal) return;  
    modal.style.display = 'none';  
    modal.setAttribute('aria-hidden','true');  
  }  

  const editProfileBtn = document.getElementById('editProfileBtn');  
  if(editProfileBtn) editProfileBtn.addEventListener('click', ()=> {  
    document.getElementById('inpName').value = document.getElementById('userName').textContent;  
    openModal('editModal');  
  });  
  const closeEdit = document.getElementById('closeEdit'); if(closeEdit) closeEdit.addEventListener('click', ()=> closeModal('editModal'));  
  const cancelEdit = document.getElementById('cancelEdit'); if(cancelEdit) cancelEdit.addEventListener('click', ()=> closeModal('editModal'));  
  const saveProfile = document.getElementById('saveProfile'); if(saveProfile) saveProfile.addEventListener('click', ()=> {  
    const newName = document.getElementById('inpName').value || '---';  
    document.getElementById('userName').textContent = newName;  
    closeModal('editModal');  
    alert('Profile saved (demo). Connect to backend to persist.');  
  });  

  const changePassBtn = document.getElementById('changePassBtn'); if(changePassBtn) changePassBtn.addEventListener('click', ()=> openModal('passModal'));  
  const closePass = document.getElementById('closePass'); if(closePass) closePass.addEventListener('click', ()=> closeModal('passModal'));  
  const cancelPass = document.getElementById('cancelPass'); if(cancelPass) cancelPass.addEventListener('click', ()=> closeModal('passModal'));  
  const savePass = document.getElementById('savePass'); if(savePass) savePass.addEventListener('click', ()=> {  
    closeModal('passModal');  
    alert('Password changed (demo). Connect to backend for real change.');  
  });  

  function toggleElement(el){  
    el.classList.toggle('on');  
    const isOn = el.classList.contains('on');  
    el.setAttribute('aria-checked', isOn ? 'true' : 'false');  
  }  
  const twoFAToggle = document.getElementById('twoFAToggle'); if(twoFAToggle) twoFAToggle.addEventListener('click', function(){ toggleElement(this); });  
  const notifToggle = document.getElementById('notifToggle'); if(notifToggle) notifToggle.addEventListener('click', function(){ toggleElement(this); });  

  function openPlanDetails(name){  
    alert('Open details for ' + name + ' (demo). Implement modal or page for full details.');  
  }  
  window.openPlanDetails = openPlanDetails;  

  const backBtn = document.getElementById('backBtn'); if(backBtn) backBtn.addEventListener('click', ()=> window.history.back());  
  const viewAllTx = document.getElementById('viewAllTx'); if(viewAllTx) viewAllTx.addEventListener('click', ()=> alert('Open transactions page (demo)'));  
  const managePayments = document.getElementById('managePayments'); if(managePayments) managePayments.addEventListener('click', ()=> alert('Open payment methods (demo)'));  

  document.querySelectorAll('.modal-wrap').forEach(mw=>{  
    mw.addEventListener('click', e=>{ if(e.target === mw) mw.style.display='none'; });  
  });  
  document.addEventListener('keydown', e=>{ if(e.key === 'Escape'){ document.querySelectorAll('.modal-wrap').forEach(mw=> mw.style.display='none'); } });  

  // ensure Lucide icons are rendered (including avatar user icon)
  // (Already called on DOMContentLoaded)  
</script>  
</body>  
</html>